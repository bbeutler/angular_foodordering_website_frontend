{"version":3,"file":"menu.component.js","sourceRoot":"","sources":["../../../../../.ng_build/theme/components/menu/menu.component.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nimport {\n  Component,\n  Input,\n  Output,\n  EventEmitter,\n  OnInit,\n  OnDestroy,\n  HostBinding,\n  ViewChildren,\n  QueryList,\n  ElementRef,\n  AfterViewInit,\n  PLATFORM_ID,\n  Inject,\n  ChangeDetectorRef,\n} from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { Router, NavigationEnd } from '@angular/router';\nimport { BehaviorSubject } from 'rxjs';\nimport { takeWhile, filter } from 'rxjs/operators';\n\nimport { NbMenuInternalService, NbMenuItem, NbMenuService, NbMenuBag } from './menu.service';\nimport { convertToBoolProperty, getElementHeight } from '../helpers';\nimport { NB_WINDOW } from '../../theme.options';\n\nfunction sumSubmenuHeight(item: NbMenuItem) {\n  return item.expanded\n    ? (item.subMenuHeight || 0) + item.children.filter(c => c.children).reduce((acc, c) => acc + sumSubmenuHeight(c), 0)\n    : 0;\n}\n\n@Component({\n  // tslint:disable-next-line:component-selector\n  selector: '[nbMenuItem]',\n  templateUrl: './menu-item.component.html',\n})\nexport class NbMenuItemComponent implements AfterViewInit, OnDestroy {\n  @Input() menuItem = <NbMenuItem>null;\n\n  @Output() hoverItem = new EventEmitter<any>();\n  @Output() toggleSubMenu = new EventEmitter<any>();\n  @Output() selectItem = new EventEmitter<any>();\n  @Output() itemClick = new EventEmitter<any>();\n\n  private alive: boolean = true;\n\n  @ViewChildren(NbMenuItemComponent, { read: ElementRef }) subMenu: QueryList<ElementRef>;\n  maxHeight: number = 0;\n\n  constructor(\n    private menuService: NbMenuService,\n    @Inject(PLATFORM_ID) private platformId: Object,\n    private changeDetection: ChangeDetectorRef,\n  ) { }\n\n  ngAfterViewInit() {\n    this.subMenu.changes\n      .pipe(takeWhile(() => this.alive))\n      .subscribe(() => {\n        this.updateSubmenuHeight();\n        this.updateMaxHeight();\n      });\n\n    this.menuService.onSubmenuToggle()\n      .pipe(takeWhile(() => this.alive))\n      .subscribe(() => this.updateMaxHeight());\n\n    this.updateSubmenuHeight();\n    this.updateMaxHeight();\n    this.changeDetection.detectChanges();\n  }\n\n  ngOnDestroy() {\n    this.alive = false;\n  }\n\n  updateSubmenuHeight() {\n    if (isPlatformBrowser(this.platformId)) {\n      this.menuItem.subMenuHeight = this.subMenu.reduce(\n        (acc, c) => acc + getElementHeight(c.nativeElement),\n        0,\n      );\n    }\n  }\n\n  updateMaxHeight() {\n    this.maxHeight = sumSubmenuHeight(this.menuItem);\n  }\n\n  onToggleSubMenu(item: NbMenuItem) {\n    this.toggleSubMenu.emit(item);\n  }\n\n  onHoverItem(item: NbMenuItem) {\n    this.hoverItem.emit(item);\n  }\n\n  onSelectItem(item: NbMenuItem) {\n    this.selectItem.emit(item);\n  }\n\n  onItemClick(item: NbMenuItem) {\n    this.itemClick.emit(item);\n  }\n}\n\n/**\n * Vertical menu component.\n *\n * Accepts a list of menu items and renders them accordingly. Supports multi-level menus.\n *\n * @example Basic usage\n *\n * ```\n * // ...\n * menuItems: NbMenuItem[] = [{ title: home, link: '/' }, { title: dashboard, link: 'dashboard' }];\n * // ...\n * <nb-menu [items]=\"menuItems\"></nb-menu>\n * ```\n *\n * @styles\n *\n * menu-font-family:\n * menu-font-size:\n * menu-font-weight:\n * menu-fg:\n * menu-bg:\n * menu-active-fg:\n * menu-active-bg:\n * menu-active-font-weight:\n * menu-submenu-bg:\n * menu-submenu-fg:\n * menu-submenu-active-fg:\n * menu-submenu-active-bg:\n * menu-submenu-active-border-color:\n * menu-submenu-active-shadow:\n * menu-submenu-hover-fg:\n * menu-submenu-hover-bg:\n * menu-submenu-item-border-width:\n * menu-submenu-item-border-radius:\n * menu-submenu-item-padding:\n * menu-submenu-item-container-padding:\n * menu-submenu-padding:\n * menu-group-font-weight:\n * menu-group-font-size:\n * menu-group-fg:\n * menu-group-padding\n * menu-item-padding:\n * menu-item-separator:\n * menu-icon-font-size:\n * menu-icon-margin:\n * menu-icon-color:\n * menu-icon-active-color:\n */\n@Component({\n  selector: 'nb-menu',\n  styleUrls: ['./menu.component.css'],\n  template: `\n    <ul class=\"menu-items\">\n      <ng-container *ngFor=\"let item of items\">\n        <li nbMenuItem *ngIf=\"!item.hidden\"\n            [menuItem]=\"item\"\n            [class.menu-group]=\"item.group\"\n            (hoverItem)=\"onHoverItem($event)\"\n            (toggleSubMenu)=\"onToggleSubMenu($event)\"\n            (selectItem)=\"onSelectItem($event)\"\n            (itemClick)=\"onItemClick($event)\"\n            class=\"menu-item\">\n        </li>\n      </ng-container>\n    </ul>\n  `,\n})\nexport class NbMenuComponent implements OnInit, AfterViewInit, OnDestroy {\n  @HostBinding('class.inverse') inverseValue: boolean;\n\n  /**\n   * Tags a menu with some ID, can be later used in the menu service\n   * to determine which menu triggered the action, if multiple menus exist on the page.\n   *\n   * @type {string}\n   */\n  @Input() tag: string;\n\n  /**\n   * List of menu items.\n   * @type List<NbMenuItem> | List<any> | any\n   */\n  @Input() items: NbMenuItem[];\n\n  /**\n   * Makes colors inverse based on current theme\n   * @type boolean\n   */\n  @Input()\n  set inverse(val: boolean) {\n    this.inverseValue = convertToBoolProperty(val);\n  }\n\n  /**\n   * Collapse all opened submenus on the toggle event\n   * Default value is \"false\"\n   * @type boolean\n   */\n  @Input()\n  set autoCollapse(val: boolean) {\n    this.autoCollapseValue = convertToBoolProperty(val);\n  }\n\n  private alive: boolean = true;\n  private autoCollapseValue: boolean = false;\n\n  constructor(@Inject(NB_WINDOW) private window,\n              private menuInternalService: NbMenuInternalService,\n              private router: Router) {\n  }\n\n  ngOnInit() {\n    this.menuInternalService\n      .onAddItem()\n      .pipe(\n        takeWhile(() => this.alive),\n        filter((data: { tag: string; items: NbMenuItem[] }) => this.compareTag(data.tag)),\n      )\n      .subscribe(data => this.onAddItem(data));\n\n    this.menuInternalService\n      .onNavigateHome()\n      .pipe(\n        takeWhile(() => this.alive),\n        filter((data: { tag: string; items: NbMenuItem[] }) => this.compareTag(data.tag)),\n      )\n      .subscribe(() => this.navigateHome());\n\n    this.menuInternalService\n      .onGetSelectedItem()\n      .pipe(\n        takeWhile(() => this.alive),\n        filter((data: { tag: string; listener: BehaviorSubject<NbMenuBag> }) => this.compareTag(data.tag)),\n      )\n      .subscribe((data: { tag: string; listener: BehaviorSubject<NbMenuBag> }) => {\n        data.listener.next({ tag: this.tag, item: this.getSelectedItem(this.items) });\n      });\n\n    this.router.events\n      .pipe(\n        takeWhile(() => this.alive),\n        filter(event => event instanceof NavigationEnd),\n      )\n      .subscribe(() => {\n        this.menuInternalService.resetItems(this.items);\n        this.menuInternalService.updateSelection(this.items, this.tag, this.autoCollapseValue)\n      });\n\n    // TODO: this probably won't work if you pass items dynamically into items input\n    this.menuInternalService.prepareItems(this.items);\n    this.items.push(...this.menuInternalService.getItems());\n  }\n\n  ngAfterViewInit() {\n    setTimeout(() => this.menuInternalService.updateSelection(this.items, this.tag));\n  }\n\n  onAddItem(data: { tag: string; items: NbMenuItem[] }) {\n    this.items.push(...data.items);\n\n    this.menuInternalService.prepareItems(this.items);\n    this.menuInternalService.updateSelection(this.items, this.tag, this.autoCollapseValue);\n  }\n\n  onHoverItem(item: NbMenuItem) {\n    this.menuInternalService.itemHover(item, this.tag);\n  }\n\n  onToggleSubMenu(item: NbMenuItem) {\n    if (this.autoCollapseValue) {\n      this.menuInternalService.collapseAll(this.items, this.tag, item);\n    }\n    item.expanded = !item.expanded;\n    this.menuInternalService.submenuToggle(item, this.tag);\n  }\n\n  // TODO: is not fired on page reload\n  onSelectItem(item: NbMenuItem) {\n    this.menuInternalService.resetItems(this.items);\n    this.menuInternalService.selectItem(item, this.tag);\n  }\n\n  onItemClick(item: NbMenuItem) {\n    this.menuInternalService.itemClick(item, this.tag);\n  }\n\n  ngOnDestroy() {\n    this.alive = false;\n  }\n\n  private navigateHome() {\n    const homeItem = this.getHomeItem(this.items);\n\n    if (homeItem) {\n      if (homeItem.link) {\n        this.router.navigate([homeItem.link], { queryParams: homeItem.queryParams, fragment: homeItem.fragment });\n      }\n\n      if (homeItem.url) {\n        this.window.location.href = homeItem.url;\n      }\n    }\n  }\n\n  private getHomeItem(items: NbMenuItem[]): NbMenuItem {\n    for (const item of items) {\n      if (item.home) {\n        return item;\n      }\n\n      const homeItem = item.children && this.getHomeItem(item.children);\n      if (homeItem) {\n        return homeItem;\n      }\n    }\n  }\n\n  private compareTag(tag: string) {\n    return !tag || tag === this.tag;\n  }\n\n  private getSelectedItem(items: NbMenuItem[]): NbMenuItem {\n    let selected = null;\n    items.forEach((item: NbMenuItem) => {\n      if (item.selected) {\n        selected = item;\n      }\n      if (item.selected && item.children && item.children.length > 0) {\n        selected = this.getSelectedItem(item.children);\n      }\n    });\n    return selected;\n  }\n}\n"]}