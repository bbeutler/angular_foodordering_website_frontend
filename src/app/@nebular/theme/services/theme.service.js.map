{"version":3,"file":"theme.service.js","sourceRoot":"","sources":["../../../../.ng_build/theme/services/theme.service.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */\n\nimport { ComponentFactory, ComponentFactoryResolver, Inject, Injectable, Type } from '@angular/core';\n\nimport { Observable, ReplaySubject, Subject, BehaviorSubject } from 'rxjs';\nimport { map, filter, pairwise, distinctUntilChanged, startWith, share } from 'rxjs/operators';\n\nimport { nbThemeOptionsToken } from '../theme.options';\nimport { NbJSThemeOptions } from './js-themes/theme.options';\nimport { NbJSThemesRegistry } from './js-themes-registry.service';\nimport { NbMediaBreakpointsService, NbMediaBreakpoint } from './breakpoints.service';\n\n/**\n * Main Nebular service. Includes various helper methods.\n */\n@Injectable()\nexport class NbThemeService {\n\n  // TODO: behavioral subject here?\n  currentTheme: string;\n  private themeChanges$ = new ReplaySubject(1);\n  private appendToLayoutTop$ = new ReplaySubject();\n  private createLayoutTop$ = new Subject();\n  private appendLayoutClass$ = new Subject();\n  private removeLayoutClass$ = new Subject();\n  private changeWindowWidth$ = new ReplaySubject<number>(2);\n\n  constructor(\n    @Inject(nbThemeOptionsToken) protected options: any,\n    private breakpointService: NbMediaBreakpointsService,\n    private jsThemesRegistry: NbJSThemesRegistry,\n    private componentFactoryResolver: ComponentFactoryResolver,\n  ) {\n    if (options && options.name) {\n      this.changeTheme(options.name);\n    }\n  }\n\n  changeTheme(name: string): void {\n    this.themeChanges$.next({ name, previous: this.currentTheme });\n    this.currentTheme = name;\n  }\n\n  changeWindowWidth(width: number): void {\n    this.changeWindowWidth$.next(width);\n  }\n\n  appendToLayoutTop<T>(entity: Type<T> | ComponentFactory<T>): Observable<any> {\n    let factory = entity;\n\n    if (entity instanceof Type) {\n      factory = this.componentFactoryResolver.resolveComponentFactory(entity);\n    }\n\n    const subject = new ReplaySubject(1);\n    this.appendToLayoutTop$.next({ factory, listener: subject });\n    return subject.asObservable();\n  }\n\n  /**\n   * Returns a theme object with variables (color/paddings/etc) on a theme change.\n   * Once subscribed - returns current theme.\n   *\n   * @returns {Observable<NbJSThemeOptions>}\n   */\n  getJsTheme(): Observable<NbJSThemeOptions> {\n    return this.onThemeChange().pipe(\n      map((theme: any) => {\n        return this.jsThemesRegistry.get(theme.name);\n      }),\n    );\n  }\n\n  clearLayoutTop(): Observable<any> {\n    const observable = new BehaviorSubject(null);\n    this.createLayoutTop$.next({ listener: observable });\n    this.appendToLayoutTop$ = new ReplaySubject();\n    return observable.asObservable();\n  }\n\n  /**\n   * Triggers media query breakpoint change\n   * Returns a pair where the first item is previous media breakpoint and the second item is current breakpoit.\n   * ```\n   *  [{ name: 'xs', width: 0 }, { name: 'md', width: 768 }] // change from `xs` to `md`\n   * ```\n   * @returns {Observable<[NbMediaBreakpoint, NbMediaBreakpoint]>}\n   */\n  onMediaQueryChange(): Observable<NbMediaBreakpoint[]> {\n    return this.changeWindowWidth$\n      .pipe(\n        startWith(undefined),\n        pairwise(),\n        map(([prevWidth, width]: [number, number]) => {\n          return [\n            this.breakpointService.getByWidth(prevWidth),\n            this.breakpointService.getByWidth(width),\n          ]\n        }),\n        filter(([prevPoint, point]: [NbMediaBreakpoint, NbMediaBreakpoint]) => {\n          return prevPoint.name !== point.name;\n        }),\n        distinctUntilChanged(null, params => params[0].name + params[1].name),\n        share(),\n      );\n  }\n\n  onThemeChange(): Observable<any> {\n    return this.themeChanges$.pipe(share());\n  }\n\n  onAppendToTop(): Observable<any> {\n    return this.appendToLayoutTop$.pipe(share());\n  }\n\n  onClearLayoutTop(): Observable<any> {\n    return this.createLayoutTop$.pipe(share());\n  }\n\n  appendLayoutClass(className: string) {\n    this.appendLayoutClass$.next(className);\n  }\n\n  onAppendLayoutClass(): Observable<any> {\n    return this.appendLayoutClass$.pipe(share());\n  }\n\n  removeLayoutClass(className: string) {\n    this.removeLayoutClass$.next(className);\n  }\n\n  onRemoveLayoutClass(): Observable<any> {\n    return this.removeLayoutClass$.pipe(share());\n  }\n}\n"]}